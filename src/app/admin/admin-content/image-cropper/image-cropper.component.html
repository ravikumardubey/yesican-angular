<div *ngIf="showLoading" class="text-center p-5">
  <div class="spinner-border text-danger" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>
<div class="d-flex flex-column w-100 h-100">
  <div class="d-flex justify-content-center align-items-center">
    <image-cropper
      style="border-top-left-radius: 10px; border-top-right-radius: 10px"
      format="png"
      (imageCropped)="imageCropped($event)"
      (imageLoaded)="imageLoaded($event)"
      [imageChangedEvent]="imageChangedEvent"
      [maintainAspectRatio]="maintainAspectRatio"
      [cropperMinHeight]="200"
      [cropperMinWidth]="200"
      [aspectRatio]="aspectRatio"
      [containWithinAspectRatio]="false"
      [canvasRotation]="canvasRotation"
      [transform]="transform"
      [onlyScaleDown]="true"
      (cropperReady)="cropperReady($event)"
      (loadImageFailed)="loadImageFailed()"
      output="base64"
    ></image-cropper>
  </div>
  <div class="d-flex flex-column border-top">
    <div class="d-flex flex-row justify-content-center align-items-center py-2">
      <div
        class="cursor-pointer px-2"
        title="Reset Image"
        (click)="rotateImage()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
        >
          <path
            fill="currentColor"
            d="M7.47 21.49C4.2 19.93 1.86 16.76 1.5 13H0c.51 6.16 5.66 11 11.95 11c.23 0 .44-.02.66-.03L8.8 20.15l-1.33 1.34zM12.05 0c-.23 0-.44.02-.66.04l3.81 3.81l1.33-1.33C19.8 4.07 22.14 7.24 22.5 11H24c-.51-6.16-5.66-11-11.95-11zM16 14h2V8a2 2 0 0 0-2-2h-6v2h6v6zm-8 2V4H6v2H4v2h2v8a2 2 0 0 0 2 2h8v2h2v-2h2v-2H8z"
          />
        </svg>
      </div>
      <div class="cursor-pointer px-2" title="Zoom Out" (click)="zoomOut()">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
        >
          <path
            fill="currentColor"
            d="m18.031 16.617l4.283 4.282l-1.415 1.415l-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9s9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.868-3.133-7-7-7c-3.868 0-7 3.132-7 7c0 3.867 3.132 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15zM7 10h8v2H7v-2z"
          />
        </svg>
      </div>
      <div class="cursor-pointer px-2" title="Zoom In" (click)="zoomIn()">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
        >
          <path
            fill="currentColor"
            d="m18.031 16.617l4.283 4.282l-1.415 1.415l-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9s9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.868-3.133-7-7-7c-3.868 0-7 3.132-7 7c0 3.867 3.132 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15zM10 10V7h2v3h3v2h-3v3h-2v-3H7v-2h3z"
          />
        </svg>
      </div>
      <div
        class="cursor-pointer px-2"
        title="Reset Image"
        (click)="resetImage()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
        >
          <path
            fill="currentColor"
            d="M3 9V3h2v3.35Q6.25 4.8 8.063 3.9T12 3q2.95 0 5.263 1.675T20.5 9h-2.175q-.85-1.8-2.525-2.9T12 5q-1.425 0-2.688.525T7.1 7H9v2H3Zm3 9h12l-3.75-5l-3 4L9 14l-3 4Zm-1 4q-.825 0-1.413-.588T3 20v-8h2v8h14v-8h2v8q0 .825-.588 1.413T19 22H5Z"
          />
        </svg>
      </div>
    </div>

    <div
      class="d-flex flex-row justify-content-around align-items-center border-top py-3"
    >
      <div
        class="text-secondary text-center cursor-pointer"
        (click)="closeModal.emit()"
      >
        <h4 class="fs-6 m-0">Cancel</h4>
      </div>
      <div class="text-center cursor-pointer vk-text" (click)="cropImage()">
        <h4 class="fs-6 m-0">Save</h4>
      </div>
    </div>
  </div>
</div>
